<div class="container">
  <div class="row">
    <div class="col-sm-12 mt-5">
      <% if flash[:alert] %>
        <div class="alert alert-warning"><%= flash[:alert] %></div>
      <% end %>
      <div class="mx-auto mt-5">
        <%= form_with(url: search_path, method: 'get', local: true) do %>
          <div class="form-group">
            <%= label_tag :repositories, 'Search for repositories ' %>
            <%= text_field_tag :repositories, nil, placeholder: 'Enter search text...', class: 'form-control' %>
          </div>
            <%= button_tag 'Search', class: 'btn btn-primary' %>
        <% end %>
      </div>
    </div>
  </div>


  <div class="row mt-5">
    <h2 class="col-md-8">Search Results</h2>

    <div class="col-md-4">
      Total count: <span class="badge badge-pill badge-success"><%= @repositories.present? ? @repositories['total_count'] : 0  %></span></div>
  </div>

  <table class="table table-striped">
    <thead>
    <tr>
      <th>Repo Name</th>
      <th>Repo Owner</th>
      <th>Repo Description</th>
    </tr>
    </thead>
    <tbody>
    <% if @repositories.present? && @repositories['total_count'] != 0 %>
      <% @repositories['items'].each do |repo| %>
        <tr>
          <td><%= repo['name'] %></td>
          <td><%= repo['owner']['login'] %></td>
          <td><%= repo['description'] %></td>
        </tr>
      <% end %>
    <% else %>
      <tr>
        <td></td>
        <td><p>No repositories</p></td>
        <td></td>
      </tr>
    <% end %>
    </tbody>
  </table>
</div>
